"use strict";!function(){function e(e,t){this.grid=e,this.options=t||{}}function t(e){var t=this.sources.treeview,i=!(!t||!t.viewMakesSense());return i&&e&&e.dataCell&&(i=e.dataCell.x===t.treeColumn.index),i}e.prototype={constructor:e.prototype.constructor,setPipeline:function(i){i=i||{};var o=this instanceof e,a=i.dataModelPrototype||o&&this.grid.behavior.dataModel,r=i.firstPipe||a.pipeline[0];if(!a)throw"Expected dataModel.";if(!r)throw"Expected pipe (data source pipeline descriptor).";i.dataModelPrototype?(a.truncatePipeline(),a.addPipe(r)):a.pipeline=[r],i.includeFilter&&a.addPipe({type:"DataSourceGlobalFilter"}),i.includeSorter&&a.addPipe({type:"DataSourceTreeviewSorter"}),a.addPipe({type:"DataSourceTreeview",test:t}),o&&(this.grid.behavior.setData(),this.dataSource=a.sources.dataSource,this.grid.behavior.shapeChanged())},setRelation:function(e,t){var i=e&&this.options,o=this.grid.behavior,a=o.dataModel,r=this.dataSource=a.sources.treeview,n=r.setRelation(i),s=o.getPrivateState(),d=o.getColumn(r.treeColumn.index).getProperties();if(n){if(this.editableWas=!!d.editable,d.editable=!1,this.checkboxOnlyRowSelectionsWas=s.checkboxOnlyRowSelections,s.checkboxOnlyRowSelections=!0,t){var l=[r.idColumn.index,r.parentIdColumn.index];l.forEach(function(e){var t=o.getActiveColumnIndex(e);void 0!==t&&o.columns.splice(t,1)})}}else d.editable=this.editableWas,s.checkboxOnlyRowSelections=this.checkboxOnlyRowSelectionsWas;return this.grid.selectionModel.clear(),this.grid.clearMouseDown(),a.applyAnalytics(),o.shapeChanged(),n}},window.fin.Hypergrid.TreeView=e}();